{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/assets/dcat/extra/Upload/Helper.js","webpack:///./resources/assets/dcat/extra/Upload/Request.js","webpack:///./resources/assets/dcat/extra/Upload/Input.js","webpack:///./resources/assets/dcat/extra/Upload/Status.js","webpack:///./resources/assets/dcat/extra/Upload/AddFile.js","webpack:///./resources/assets/dcat/extra/Upload/AddUploadedFile.js","webpack:///./resources/assets/dcat/extra/upload.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Helper","Uploder","this","uploader","isSupportBase64","supportBase64","data","Image","support","onload","onerror","width","height","src","response","message","Dcat","error","$this","$li","parents","first","fileId","order","$prev","prev","$next","next","length","swrapUploadedFile","reRenderUploadedFiles","uploadedFiles","addUploadedFile","index","parseInt","searchUploadedFile","currentFile","prevFile","nextFile","setUploadedFilesToInput","parent","files","push","serverId","input","set","Request","Uploader","file","callback","options","confirm","lang","trans","post","deleteData","removeFile","_column","getColumn","_relation","relation","loading","$","url","deleteUrl","success","result","status","helper","showError","updateColumn","values","num","getStats","successNum","form","extend","formData","autoUpdateColumn","join","updateServer","Input","$selector","find","inputSelector","val","split","id","arr","filter","v","k","self","indexOf","trigger","deleteUploadedFile","html","Status","state","originalFilesNum","helpers","len","preview","args","$uploadButton","removeClass","addClass","pending","ready","uploading","paused","finish","decrOriginalFileNum","incrOriginalFileNum","decrFileNumLimit","incrFileNumLimit","init","updateStatusText","stats","$progress","hide","addFileButton","text","uploadFailNum","show","disabled","$placeholder","$files","$statusBar","isImage","$wrapper","removeAttr","refresh","fileLimit","option","css","setTimeout","removeValidatorErrors","upload","fileNumLimit","request","numOfSuccess","reload","updateProgress","__","showSuccess","fileCount","size","WebUploader","formatSize","fileSize","fail","$infoBox","percent","loaded","total","$bar","each","percentages","Math","round","AddFile","$btns","showImg","fileName","getFileViewSelector","ext","toUpperCase","appendTo","nam","margin","getStatus","statusText","showImage","rotation","on","resolveStatusChangeCallback","resolveActionsCallback","code","$info","faildFiles","_this","$wrap","image","makeThumb","img","empty","append","once","_info","info","_meta","meta","validateDimensions","resize","e","cur","a","removeError","removable","previewImage","attr","orderFiles","window","open","remove","dimensions","isset","type","match","AddUploadedFile","serverPath","sortable","downloadable","serverUrl","deleteFile","removeFormFile","click","formFiles","add","render","fake","w","wrapper","server","autoUpload","thumbHeight","elementName","exceed_size","interrupt","upload_failed","selected_files","selected_has_failed","selected_success","dot","failed_num","pause_upload","go_on_upload","start_upload","upload_success_message","go_on_add","Q_TYPE_DENIED","Q_EXCEED_NUM_LIMIT","F_EXCEED_SIZE","Q_EXCEED_SIZE_LIMIT","F_DUPLICATE","confirm_delete_file","_id","thumb","quality","allowMagnify","crop","preserveHeaders","selector","upload_column","random","addFile","Translator","$queue","$upload","addButton","label","items","denied","onUploadProgress","percentage","onFileQueued","onFileDequeued","removeUploadFile","obj","reason","update","_uploadAccept","onError","warning","hasClass","stop","retry","merge","serverName","path","getFileView","$download","pop","reRender","replace","off","end","jQuery"],"mappings":"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","file":"/resources/dist/dcat/extra/upload.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 12);\n","\r\nexport default class Helper {\r\n    constructor(Uploder) {\r\n        this.uploader = Uploder;\r\n\r\n        this.isSupportBase64 = this.supportBase64();\r\n    }\r\n\r\n    // 判断是否支持base64\r\n    supportBase64() {\r\n        let data = new Image(),\r\n            support = true;\r\n\r\n        data.onload = data.onerror = function () {\r\n            if (this.width != 1 || this.height != 1) {\r\n                support = false;\r\n            }\r\n        };\r\n        data.src = \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==\";\r\n\r\n        return support;\r\n    }\r\n\r\n    // 显示api响应的错误信息\r\n    showError(response) {\r\n        var message = 'Unknown error!';\r\n        if (response && response.data) {\r\n            message = response.data.message || message;\r\n        }\r\n\r\n        Dcat.error(message)\r\n    }\r\n\r\n    // 文件排序\r\n    orderFiles($this) {\r\n        var _this = this,\r\n            $li = $this.parents('li').first(),\r\n            fileId = $this.data('id'),\r\n            order = $this.data('order'),\r\n            $prev = $li.prev(),\r\n            $next = $li.next();\r\n\r\n        if (order) {\r\n            // 升序\r\n            if (!$prev.length) {\r\n                return;\r\n            }\r\n            _this.swrapUploadedFile(fileId, order);\r\n            _this.uploader.reRenderUploadedFiles();\r\n\r\n            return;\r\n        }\r\n\r\n        if (!$next.length) {\r\n            return;\r\n        }\r\n\r\n        _this.swrapUploadedFile(fileId, order);\r\n        _this.uploader.reRenderUploadedFiles();\r\n    }\r\n\r\n    // 交换文件排序\r\n    swrapUploadedFile(fileId, order) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploadedFiles = parent.addUploadedFile.uploadedFiles,\r\n            index = parseInt(_this.searchUploadedFile(fileId)),\r\n            currentFile = uploadedFiles[index],\r\n            prevFile = uploadedFiles[index - 1],\r\n            nextFile = uploadedFiles[index + 1];\r\n\r\n        if (order) {\r\n            if (index === 0) {\r\n                return;\r\n            }\r\n\r\n            uploadedFiles[index - 1] = currentFile;\r\n            uploadedFiles[index] = prevFile;\r\n        } else {\r\n            if (!nextFile) {\r\n                return;\r\n            }\r\n\r\n            uploadedFiles[index + 1] = currentFile;\r\n            uploadedFiles[index] = nextFile;\r\n        }\r\n\r\n        _this.setUploadedFilesToInput();\r\n    }\r\n\r\n    setUploadedFilesToInput() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploadedFiles = parent.addUploadedFile.uploadedFiles,\r\n            files = [],\r\n            i;\r\n\r\n        for (i in uploadedFiles) {\r\n            if (uploadedFiles[i]) {\r\n                files.push(uploadedFiles[i].serverId);\r\n            }\r\n        }\r\n\r\n        parent.input.set(files);\r\n    }\r\n\r\n    // 查找文件位置\r\n    searchUploadedFile(fileId) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploadedFiles = parent.addUploadedFile.uploadedFiles;\r\n\r\n        for (var i in uploadedFiles) {\r\n            if (uploadedFiles[i].serverId === fileId) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n}\r\n","\r\nexport default class Request {\r\n    constructor(Uploader) {\r\n        this.uploader = Uploader;\r\n    }\r\n\r\n    delete(file, callback) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options,\r\n            uploader = parent.uploader;\r\n\r\n        Dcat.confirm(parent.lang.trans('confirm_delete_file'), file.serverId, function () {\r\n            var post = options.deleteData;\r\n\r\n            post.key = file.serverId;\r\n\r\n            if (! post.key) {\r\n                parent.input.delete(file.serverId);\r\n\r\n                return uploader.removeFile(file);\r\n            }\r\n\r\n            post._column = parent.getColumn();\r\n            post._relation = parent.relation;\r\n\r\n            Dcat.loading();\r\n\r\n            $.post({\r\n                url: options.deleteUrl,\r\n                data: post,\r\n                success: function (result) {\r\n                    Dcat.loading(false);\r\n\r\n                    if (result.status) {\r\n                        callback(result);\r\n\r\n                        return;\r\n                    }\r\n\r\n                    parent.helper.showError(result)\r\n                }\r\n            });\r\n\r\n        });\r\n    }\r\n\r\n    // 保存已上传的文件名到服务器\r\n    update() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            options = parent.options,\r\n            updateColumn = parent.getColumn(),\r\n            relation = _this.relation,\r\n            values = parent.input.get(), // 获取表单值\r\n            num = uploader.getStats().successNum,\r\n            form = $.extend({}, options.formData);\r\n\r\n        if (!num || !values || !options.autoUpdateColumn) {\r\n            return;\r\n        }\r\n\r\n        if (relation) {\r\n            if (!relation[1]) {\r\n                // 新增子表记录，则不调用update接口\r\n                return;\r\n            }\r\n\r\n            form[relation[0]] = {};\r\n\r\n            form[relation[0]][relation[1]] = {};\r\n            form[relation[0]][relation[1]][updateColumn] = values.join(',');\r\n        } else {\r\n            form[updateColumn] = values.join(',');\r\n        }\r\n\r\n        delete form['_relation'];\r\n        delete form['upload_column'];\r\n\r\n        $.post({\r\n            url: options.updateServer,\r\n            data: form,\r\n        });\r\n    }\r\n}","\r\nexport default class Input {\r\n    constructor(Uploder) {\r\n        this.uploader = Uploder;\r\n\r\n        this.$selector = Uploder.$selector.find(Uploder.options.inputSelector)\r\n    }\r\n\r\n    // 获取上传的文件名\r\n    get() {\r\n        let val = this.$selector.val();\r\n\r\n        return val ? val.split(',') : [];\r\n    }\r\n\r\n    // 增加文件名\r\n    add(id) {\r\n        let val = this.get();\r\n\r\n        val.push(id);\r\n\r\n        this.set(val);\r\n    }\r\n\r\n    // 设置表单值\r\n    set(arr) {\r\n        arr = arr.filter(function (v, k, self) {\r\n            return self.indexOf(v) === k;\r\n        }).filter(function (v) {\r\n            return v ? true : false;\r\n        });\r\n\r\n        // 手动触发change事件，方便监听文件变化\r\n        this.$selector.val(arr.join(',')).trigger('change');\r\n    }\r\n\r\n    // 删除表单值\r\n    delete(id) {\r\n        let _this = this;\r\n\r\n        _this.deleteUploadedFile(id);\r\n\r\n        if (!id) {\r\n            return _this.$selector.val('');\r\n        }\r\n\r\n        _this.set(_this.get().filter(function (v) {\r\n            return v != id;\r\n        }));\r\n    }\r\n\r\n    deleteUploadedFile(fileId) {\r\n        let addUploadedFile = this.uploader.addUploadedFile;\r\n\r\n        addUploadedFile.uploadedFiles = addUploadedFile.uploadedFiles.filter(function (v) {\r\n            return v.serverId != fileId;\r\n        });\r\n    }\r\n\r\n    // 移除字段验证错误提示信息\r\n    removeValidatorErrors() {\r\n        this.$selector.parents('.form-group,.form-label-group,.form-field').find('.with-errors').html('')\r\n    }\r\n}\r\n","\r\nexport default class Status {\r\n    constructor(Uploder) {\r\n        this.uploader = Uploder;\r\n\r\n        // 可能有pending, ready, uploading, confirm, done.\r\n        this.state = 'pending';\r\n\r\n        // 已上传文件数量\r\n        this.originalFilesNum = Dcat.helpers.len(Uploder.options.preview);\r\n    }\r\n\r\n    switch(val, args) {\r\n        let _this = this,\r\n            parent = _this.uploader;\r\n\r\n        args = args || {};\r\n\r\n        if (val === _this.state) {\r\n            return;\r\n        }\r\n\r\n        // 上传按钮状态\r\n        if (parent.$uploadButton) {\r\n            parent.$uploadButton.removeClass('state-' + _this.state);\r\n            parent.$uploadButton.addClass('state-' + val);\r\n        }\r\n\r\n        _this.state = val;\r\n\r\n        switch (_this.state) {\r\n            case 'pending':\r\n                _this.pending();\r\n\r\n                break;\r\n\r\n            case 'ready':\r\n                _this.ready();\r\n\r\n                break;\r\n\r\n            case 'uploading':\r\n                _this.uploading();\r\n\r\n                break;\r\n\r\n            case 'paused':\r\n                _this.paused();\r\n\r\n                break;\r\n\r\n            case 'confirm':\r\n                _this.confirm();\r\n\r\n                break;\r\n            case 'finish':\r\n                _this.finish();\r\n\r\n                break;\r\n            case 'decrOriginalFileNum':\r\n                _this.decrOriginalFileNum();\r\n\r\n                break;\r\n\r\n            case 'incrOriginalFileNum':\r\n                _this.incrOriginalFileNum();\r\n\r\n                break;\r\n\r\n            case 'decrFileNumLimit': // 减少上传文件数量限制\r\n                _this.decrFileNumLimit(args.num);\r\n\r\n                break;\r\n            case 'incrFileNumLimit': // 增加上传文件数量限制\r\n                _this.incrFileNumLimit(args.num || 1);\r\n\r\n                break;\r\n            case 'init': // 初始化\r\n                _this.init();\r\n\r\n                break;\r\n        }\r\n\r\n        // 更新状态显示\r\n        _this.updateStatusText();\r\n    }\r\n\r\n    incrOriginalFileNum() {\r\n        this.originalFilesNum++;\r\n    }\r\n\r\n    decrOriginalFileNum() {\r\n        if (this.originalFilesNum > 0) {\r\n            this.originalFilesNum--;\r\n        }\r\n    }\r\n\r\n    confirm() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            stats;\r\n\r\n        if (uploader) {\r\n            parent.$progress.hide();\r\n            parent.$selector.find(parent.options.addFileButton).removeClass('element-invisible');\r\n            parent.$uploadButton.text(parent.lang.trans('start_upload'));\r\n\r\n            stats = uploader.getStats();\r\n\r\n            if (stats.successNum && !stats.uploadFailNum) {\r\n                _this.switch('finish');\r\n            }\r\n        }\r\n    }\r\n\r\n    paused() {\r\n        let _this = this,\r\n            parent = _this.uploader;\r\n\r\n        parent.$progress.show();\r\n        parent.$uploadButton.text(parent.lang.trans('go_on_upload'));\r\n    }\r\n\r\n    uploading() {\r\n        let _this = this,\r\n            parent = _this.uploader;\r\n\r\n        parent.$selector.find(parent.options.addFileButton).addClass('element-invisible');\r\n        parent.$progress.show();\r\n        parent.$uploadButton.text(parent.lang.trans('pause_upload'));\r\n    }\r\n\r\n    pending() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options;\r\n\r\n        if (options.disabled) {\r\n            return;\r\n        }\r\n        parent.$placeholder.removeClass('element-invisible');\r\n        parent.$files.hide();\r\n        parent.$statusBar.addClass('element-invisible');\r\n\r\n        if (parent.isImage()) {\r\n            parent.$wrapper.removeAttr('style');\r\n            parent.$wrapper.find('.queueList').removeAttr('style');\r\n        }\r\n\r\n        parent.uploader.refresh();\r\n    }\r\n\r\n    // 减少上传文件数量限制\r\n    decrFileNumLimit(num) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            fileLimit;\r\n\r\n        if (!uploader) {\r\n            return;\r\n        }\r\n        fileLimit = uploader.option('fileNumLimit');\r\n        num = num || 1;\r\n\r\n        if (fileLimit == '-1') {\r\n            fileLimit = 0;\r\n        }\r\n\r\n        num = fileLimit >= num ? fileLimit - num : 0;\r\n\r\n        if (num == 0) {\r\n            num = '-1';\r\n        }\r\n\r\n        uploader.option('fileNumLimit', num);\r\n    }\r\n\r\n    // 增加上传文件数量限制\r\n    incrFileNumLimit(num) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            fileLimit;\r\n\r\n        if (!uploader) {\r\n            return;\r\n        }\r\n        fileLimit = uploader.option('fileNumLimit');\r\n        num = num || 1;\r\n\r\n        if (fileLimit == '-1') {\r\n            fileLimit = 0;\r\n        }\r\n\r\n        num = fileLimit + num;\r\n\r\n        uploader.option('fileNumLimit', num);\r\n    }\r\n\r\n    ready() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options;\r\n\r\n        parent.$placeholder.addClass('element-invisible');\r\n        parent.$selector.find(parent.options.addFileButton).removeClass('element-invisible');\r\n        parent.$files.show();\r\n        if (!options.disabled) {\r\n            parent.$statusBar.removeClass('element-invisible');\r\n        }\r\n\r\n        parent.uploader.refresh();\r\n\r\n        if (parent.isImage()) {\r\n            parent.$wrapper.find('.queueList').css({'border': '1px solid #d3dde5', 'padding': '5px'});\r\n            // $wrap.find('.queueList').removeAttr('style');\r\n        }\r\n\r\n        // 移除字段验证错误信息\r\n        setTimeout(function () {\r\n            parent.input.removeValidatorErrors();\r\n        }, 10);\r\n    }\r\n\r\n    finish() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options,\r\n            uploader = parent.uploader,\r\n            stats;\r\n\r\n        if (uploader) {\r\n            stats = uploader.getStats();\r\n            if (stats.successNum) {\r\n                Dcat.success(parent.lang.trans('upload_success_message', {success: stats.successNum}));\r\n\r\n                setTimeout(function () {\r\n                    if (options.upload.fileNumLimit == 1) {\r\n                        // 单文件上传，需要重置文件上传个数\r\n                        uploader.request('get-stats').numOfSuccess = 0;\r\n                    }\r\n                }, 10);\r\n\r\n            } else {\r\n                // 没有成功的图片，重设\r\n                _this.state = 'done';\r\n\r\n                Dcat.reload();\r\n            }\r\n        }\r\n    }\r\n\r\n    // 初始化\r\n    init() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options;\r\n\r\n        parent.$uploadButton.addClass('state-' + _this.state);\r\n        _this.updateProgress();\r\n\r\n        if (_this.originalFilesNum || options.disabled) {\r\n            parent.$placeholder.addClass('element-invisible');\r\n            if (!options.disabled) {\r\n                parent.$statusBar.show();\r\n            } else {\r\n                parent.$wrapper.addClass('disabled');\r\n            }\r\n            _this.switch('ready');\r\n        } else if (parent.isImage()) {\r\n            parent.$wrapper.removeAttr('style');\r\n            parent.$wrapper.find('.queueList').css('margin', '0');\r\n        }\r\n\r\n        parent.uploader.refresh();\r\n    }\r\n\r\n    // 状态文本\r\n    updateStatusText() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            __ = parent.lang.trans.bind(parent.lang),\r\n            text = '',\r\n            stats;\r\n\r\n        if (!uploader) {\r\n            return;\r\n        }\r\n\r\n        if (_this.state === 'ready') {\r\n            stats = uploader.getStats();\r\n            if (parent.fileCount) {\r\n                text = __('selected_files', {num: parent.fileCount, size: WebUploader.formatSize(parent.fileSize)});\r\n            } else {\r\n                showSuccess();\r\n            }\r\n        } else if (_this.state === 'confirm') {\r\n            stats = uploader.getStats();\r\n            if (stats.uploadFailNum) {\r\n                text = __('selected_has_failed', {success: stats.successNum, fail: stats.uploadFailNum});\r\n            }\r\n        } else {\r\n            showSuccess();\r\n        }\r\n\r\n        function showSuccess() {\r\n            stats = uploader.getStats();\r\n            if (stats.successNum) {\r\n                text = __('selected_success', {num: parent.fileCount, size: WebUploader.formatSize(parent.fileSize), success: stats.successNum});\r\n            }\r\n\r\n            if (stats.uploadFailNum) {\r\n                text += (text ? __('dot') : '') + __('failed_num', {fail: stats.uploadFailNum});\r\n            }\r\n        }\r\n\r\n        parent.$infoBox.html(text);\r\n    }\r\n\r\n    // 进度条更新\r\n    updateProgress() {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            loaded = 0,\r\n            total = 0,\r\n            $bar = parent.$progress.find('.progress-bar'),\r\n            percent;\r\n\r\n        $.each(parent.percentages, function (k, v) {\r\n            total += v[0];\r\n            loaded += v[0] * v[1];\r\n        });\r\n\r\n        percent = total ? loaded / total : 0;\r\n        percent = Math.round(percent * 100) + '%';\r\n\r\n        $bar.text(percent);\r\n        $bar.css('width', percent);\r\n\r\n        _this.updateStatusText();\r\n    }\r\n}","\r\nexport default class AddFile {\r\n    constructor(Uploder) {\r\n        this.uploader = Uploder;\r\n    }\r\n\r\n    // 渲染新文件\r\n    render(file) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            showImg = parent.isImage(),\r\n            size = WebUploader.formatSize(file.size),\r\n            $li,\r\n            $btns,\r\n            fileName = file.name || null;\r\n\r\n        if (showImg) {\r\n            $li = $(`<li id=\"${parent.getFileViewSelector(file.id)}\" title=\"${fileName}\" >\r\n                    <p class=\"file-type\">${(file.ext.toUpperCase() || 'FILE')}</p>\r\n                    <p class=\"imgWrap \"></p>\r\n                    <p class=\"title\" style=\"\">${file.name}</p>\r\n                    <p class=\"title\" style=\"margin-bottom:20px;\">(<b>${size}</b>)</p>\r\n                    </li>`);\r\n\r\n            $btns = $(`<div class=\"file-panel\">\r\n                    <a class=\"btn btn-sm btn-white\" data-file-act=\"cancel\"><i class=\"feather icon-x red-dark\" style=\"font-size:13px\"></i></a>\r\n                    <a class=\"btn btn-sm btn-white\" data-file-act=\"delete\" style=\"display: none\">\r\n                    <i class=\"feather icon-trash red-dark\" style=\"font-size:13px\"></i></a>\r\n                    <a class=\"btn btn-sm btn-white\" data-file-act=\"preview\" ><i class=\"feather icon-zoom-in\"></i></a>\r\n                    <a class='btn btn-sm btn-white' data-file-act='order' data-order=\"1\" style=\"display: none\"><i class='feather icon-arrow-up'></i></a>\r\n                    <a class='btn btn-sm btn-white' data-file-act='order' data-order=\"0\" style=\"display: none\"><i class='feather icon-arrow-down'></i></a>\r\n\r\n                    </div>`).appendTo($li);\r\n        } else {\r\n            $li = $(`\r\n                    <li id=\"${parent.getFileViewSelector(file.id)}\" title=\"${file.nam}\">\r\n                    <p class=\"title\" style=\"display:block\">\r\n                        <i class=\"feather icon-check green _success icon-success\"></i>\r\n                        ${file.name} (${size})\r\n                    </p>\r\n                    </li>\r\n                `);\r\n\r\n            $btns = $(`\r\n<span style=\"right: 65px;\" class=\"file-action d-none\" data-file-act='order' data-order=\"1\"><i class='feather icon-arrow-up'></i></span>\r\n<span style=\"right: 45px;\" class=\"file-action d-none\" data-file-act='order' data-order=\"0\"><i class='feather icon-arrow-down'></i></span>\r\n<span style=\"right: 25px;\" class=\"file-action d-none\" data-file-act='download' data-id=''><i class='feather icon-download-cloud'></i></span>\r\n<span data-file-act=\"cancel\" class=\"file-action\" style=\"font-size:13px\">\r\n    <i class=\"feather icon-x red-dark\"></i>\r\n</span>\r\n<span data-file-act=\"delete\" class=\"file-action\" style=\"display:none\">\r\n    <i class=\"feather icon-trash red-dark\"></i>\r\n</span>\r\n`).appendTo($li);\r\n        }\r\n\r\n        $li.appendTo(parent.$files);\r\n\r\n        setTimeout(function () {\r\n            $li.css({margin: '5px'});\r\n        }, 50);\r\n\r\n        if (file.getStatus() === 'invalid') {\r\n            _this.showError($li, file.statusText, file);\r\n        } else {\r\n            if (showImg) {\r\n                // 显示图片\r\n                _this.showImage($li, file)\r\n            }\r\n\r\n            parent.percentages[file.id] = [file.size, 0];\r\n            file.rotation = 0;\r\n        }\r\n\r\n        file.on('statuschange', _this.resolveStatusChangeCallback($li, $btns, file));\r\n\r\n        let $act = showImg ? $btns.find('a') : $btns;\r\n\r\n        $act.on('click', _this.resolveActionsCallback(file));\r\n    }\r\n\r\n    // 显示错误信息\r\n    showError ($li, code, file) {\r\n        let _this = this,\r\n            lang = _this.uploader.lang,\r\n            text = '',\r\n            $info = $('<p class=\"error\"></p>');\r\n\r\n        switch (code) {\r\n            case 'exceed_size':\r\n                text = lang.trans('exceed_size');\r\n                break;\r\n\r\n            case 'interrupt':\r\n                text = lang.trans('interrupt');\r\n                break;\r\n\r\n            default:\r\n                text = lang.trans('upload_failed');\r\n                break;\r\n        }\r\n\r\n        _this.uploader.faildFiles[file.id] = file;\r\n\r\n        $info.text(text).appendTo($li);\r\n    }\r\n\r\n    // 显示图片\r\n    showImage($li, file) {\r\n        let _this = this,\r\n            uploader = _this.uploader.uploader,\r\n            lang = _this.uploader.lang,\r\n            $wrap = $li.find('p.imgWrap');\r\n\r\n        var image = uploader.makeThumb(file, function (error, src) {\r\n            var img;\r\n\r\n            $wrap.empty();\r\n            if (error) {\r\n                $li.find('.title').show();\r\n                $li.find('.file-type').show();\r\n                return;\r\n            }\r\n\r\n            if (_this.uploader.helper.isSupportBase64) {\r\n                img = $('<img src=\"' + src + '\">');\r\n                $wrap.append(img);\r\n            } else {\r\n                $li.find('.file-type').show();\r\n            }\r\n        });\r\n\r\n        try {\r\n            image.once('load', function () {\r\n                file._info = file._info || image.info();\r\n                file._meta = file._meta || image.meta();\r\n                var width = file._info.width,\r\n                    height = file._info.height;\r\n\r\n                // 验证图片宽高\r\n                if (! _this.validateDimensions(file)) {\r\n                    Dcat.error(lang.trans('dimensions') || 'The image dimensions is invalid.');\r\n\r\n                    uploader.removeFile(file);\r\n\r\n                    return false;\r\n                }\r\n\r\n                image.resize(width, height);\r\n            });\r\n        } catch (e) {\r\n            // 不是图片\r\n            return setTimeout(function () {\r\n                uploader.removeFile(file);\r\n            }, 10);\r\n        }\r\n    }\r\n\r\n    // 状态变化回调\r\n    resolveStatusChangeCallback($li, $btns, file) {\r\n        let _this = this,\r\n            parent = _this.uploader;\r\n\r\n        return function (cur, prev, a) {\r\n            if (prev === 'progress') {\r\n                // $prgress.hide().width(0);\r\n            } else if (prev === 'queued') {\r\n                $btns.find('[data-file-act=\"cancel\"]').hide();\r\n                $btns.find('[data-file-act=\"delete\"]').show();\r\n            }\r\n\r\n            // 成功\r\n            if (cur === 'error' || cur === 'invalid') {\r\n                _this.showError($li, file.statusText, file);\r\n                parent.percentages[file.id][1] = 1;\r\n\r\n            } else if (cur === 'interrupt') {\r\n                _this.showError($li, 'interrupt', file);\r\n\r\n            } else if (cur === 'queued') {\r\n                parent.percentages[file.id][1] = 0;\r\n\r\n            } else if (cur === 'progress') {\r\n                // 移除错误信息\r\n                _this.removeError($li);\r\n                // $prgress.css('display', 'block');\r\n\r\n            } else if (cur === 'complete') {\r\n                if (_this.uploader.isImage()) {\r\n                    $li.append('<span class=\"success\"><em></em><i class=\"feather icon-check\"></i></span>');\r\n                } else {\r\n                    $li.find('._success').show();\r\n                }\r\n            }\r\n\r\n            $li.removeClass('state-' + prev).addClass('state-' + cur);\r\n        };\r\n    }\r\n\r\n    // 操作按钮回调\r\n    resolveActionsCallback(file) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = parent.uploader,\r\n            helper = parent.helper;\r\n\r\n        return function () {\r\n            var index = $(this).data('file-act');\r\n\r\n            switch (index) {\r\n                case 'cancel':\r\n                    uploader.removeFile(file);\r\n                    return;\r\n                case 'deleteurl':\r\n                case 'delete':\r\n                    // 本地删除\r\n                    if (parent.options.removable) {\r\n                        parent.input.delete(file.serverId);\r\n\r\n                        return uploader.removeFile(file);\r\n                    }\r\n\r\n                    // 删除请求\r\n                    parent.request.delete(file, function () {\r\n                        // 删除成功回调\r\n                        parent.input.delete(file.serverId);\r\n\r\n                        uploader.removeFile(file);\r\n                    });\r\n\r\n                    break;\r\n                case 'preview':\r\n                    Dcat.helpers.previewImage($(this).parent().parent().find('img').attr('src'), null, file.name);\r\n\r\n                    break;\r\n                case 'order':\r\n                    $(this).attr('data-id', file.serverId);\r\n\r\n                    helper.orderFiles($(this));\r\n\r\n                    break;\r\n                case 'download':\r\n                    window.open($(this).attr('data-id'));\r\n\r\n                    break;\r\n            }\r\n\r\n        };\r\n    }\r\n\r\n    // 移除错误信息\r\n    removeError($li) {\r\n        $li.find('.error').remove()\r\n    }\r\n\r\n    // 图片宽高验证\r\n    validateDimensions(file) {\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            options = parent.options,\r\n            dimensions = options.dimensions,\r\n            width = file._info.width,\r\n            height = file._info.height,\r\n            isset = Dcat.helpers.isset;\r\n\r\n        // The image dimensions is invalid.\r\n        if (! parent.isImage() || ! _this.isImage(file) || ! Dcat.helpers.len(options.dimensions)) {\r\n            return true;\r\n        }\r\n\r\n        if (\r\n            (isset(dimensions, 'width') && dimensions['width'] != width) ||\r\n            (isset(dimensions, 'min_width') && dimensions['min_width'] > width) ||\r\n            (isset(dimensions, 'max_width') && dimensions['max_width'] < width) ||\r\n            (isset(dimensions, 'height') && dimensions['height'] != height) ||\r\n            (isset(dimensions, 'min_height') && dimensions['min_height'] > height) ||\r\n            (isset(dimensions, 'max_height') && dimensions['max_height'] < height) ||\r\n            (isset(dimensions, 'ratio') && dimensions['ratio'] != (width / height))\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    // 判断是否是图片\r\n    isImage (file) {\r\n        return file.type.match(/^image/);\r\n    }\r\n}\r\n","\r\nexport default class AddUploadedFile {\r\n    constructor(Uploder) {\r\n        this.uploader = Uploder;\r\n\r\n        // 已上传的文件\r\n        this.uploadedFiles = [];\r\n\r\n        this.init = false;\r\n    }\r\n\r\n    // 渲染已上传文件\r\n    render(file) {\r\n        let _this = this,\r\n            parent =  _this.uploader,\r\n            options = parent.options,\r\n            showImg = parent.isImage(),\r\n            html = \"\";\r\n\r\n        html += \"<li title='\" + file.serverPath + \"'>\";\r\n\r\n        if (! showImg && options.sortable) {\r\n            // 文件排序\r\n            html += `\r\n<p style=\"right: 65px\" class=\"file-action\" data-file-act='order' data-order=\"1\" data-id='${file.serverId}'><i class='feather icon-arrow-up'></i></p>\r\n<p style=\"right: 45px\" class=\"file-action\" data-file-act='order' data-order=\"0\" data-id='${file.serverId}'><i class='feather icon-arrow-down'></i></p>\r\n`;\r\n        }\r\n\r\n        // 下载\r\n        if (! showImg && options.downloadable) {\r\n            html += `\r\n<p style=\"right: 25px\" class=\"file-action\" data-file-act='download' data-id='${file.serverUrl}'><i class='feather icon-download-cloud'></i></p>\r\n`;\r\n        }\r\n\r\n        if (showImg) {\r\n            html += `<p class='imgWrap'><img src='${file.serverUrl}'></p>`\r\n        } else if (!options.disabled) {\r\n            html += `<p class=\"file-action\" data-file-act=\"delete\" data-id=\"${file.serverId}\"><i class=\"feather icon-trash red-dark\"></i></p>`;\r\n        }\r\n\r\n        html += \"<p class='title' style=''><i class='feather icon-check text-white icon-success text-white'></i>\";\r\n        html += file.serverPath;\r\n        html += \"</p>\";\r\n\r\n        if (showImg) {\r\n            html += \"<p class='title' style='margin-bottom:20px;'>&nbsp;</p>\";\r\n            html += \"<div class='file-panel' >\";\r\n\r\n            if (!options.disabled) {\r\n                html += `<a class='btn btn-sm btn-white' data-file-act='deleteurl' data-id='${file.serverId}'><i class='feather icon-trash red-dark' style='font-size:13px'></i></a>`;\r\n            }\r\n            html += `<a class='btn btn-sm btn-white' data-file-act='preview' data-url='${file.serverUrl}' ><i class='feather icon-zoom-in'></i></a>`;\r\n\r\n            if (options.sortable) {\r\n                // 文件排序\r\n                html += `\r\n<a class='btn btn-sm btn-white' data-file-act='order' data-order=\"1\" data-id='${file.serverId}'><i class='feather icon-arrow-up'></i></a>\r\n<a class='btn btn-sm btn-white' data-file-act='order' data-order=\"0\" data-id='${file.serverId}'><i class='feather icon-arrow-down'></i></a>\r\n`;\r\n            }\r\n\r\n            html += \"</div>\";\r\n        } else {\r\n\r\n        }\r\n\r\n        html += \"</li>\";\r\n        html = $(html);\r\n\r\n        if (!showImg) {\r\n            html.find('.file-type').show();\r\n            html.find('.title').show();\r\n            parent.$wrapper.css('background', 'transparent');\r\n        }\r\n\r\n        // 删除操作\r\n        let deleteFile = function () {\r\n            var fileId = $(this).data('id');\r\n\r\n            // 本地删除\r\n            if (options.removable) {\r\n                html.remove();\r\n\r\n                return _this.removeFormFile(fileId);\r\n            }\r\n\r\n            // 发起删除请求\r\n            parent.request.delete({serverId: fileId}, function () {\r\n                // 移除\r\n                html.remove();\r\n\r\n                _this.removeFormFile(fileId);\r\n            });\r\n        };\r\n\r\n        // 删除按钮点击事件\r\n        html.find('[data-file-act=\"deleteurl\"]').click(deleteFile);\r\n        html.find('[data-file-act=\"delete\"]').click(deleteFile);\r\n\r\n        // 文件排序\r\n        if (options.sortable) {\r\n            html.find('[data-file-act=\"order\"]').click(function () {\r\n                parent.helper.orderFiles($(this));\r\n            });\r\n        }\r\n\r\n        if (options.downloadable) {\r\n            html.find('[data-file-act=\"download\"]').click(function () {\r\n                window.open($(this).attr('data-id'));\r\n            });\r\n        }\r\n\r\n        // 图片预览\r\n        html.find('[data-file-act=\"preview\"]').click(function () {\r\n            var url = $(this).data('url');\r\n\r\n            Dcat.helpers.previewImage(url);\r\n        });\r\n\r\n        parent.formFiles[file.serverId] = file;\r\n\r\n        parent.input.add(file.serverId);\r\n\r\n        parent.$files.append(html);\r\n\r\n        if (showImg) {\r\n            setTimeout(function () {\r\n                html.css('margin', '5px');\r\n            }, _this.init ? 0 : 400);\r\n\r\n            _this.init = 1;\r\n        }\r\n    }\r\n\r\n    // 重新渲染已上传的文件\r\n    reRender() {\r\n        for (let i in this.uploadedFiles) {\r\n            if (this.uploadedFiles[i]) {\r\n                this.render(this.uploadedFiles[i])\r\n            }\r\n        }\r\n    }\r\n\r\n    // 移除已上传文件\r\n    removeFormFile(fileId) {\r\n        if (!fileId) {\r\n            return;\r\n        }\r\n\r\n        let _this = this,\r\n            parent = _this.uploader,\r\n            uploader = _this.uploader,\r\n            file = parent.formFiles[fileId];\r\n\r\n        parent.input.delete(fileId);\r\n\r\n        delete parent.formFiles[fileId];\r\n\r\n        if (uploader && !file.fake) {\r\n            uploader.removeFile(file);\r\n        }\r\n\r\n        parent.status.switch('decrOriginalFileNum');\r\n        parent.status.switch('incrFileNumLimit');\r\n\r\n        if (! Dcat.helpers.len(parent.formFiles) && ! Dcat.helpers.len(parent.percentages)) {\r\n            parent.status.switch('pending');\r\n        }\r\n    }\r\n\r\n    add(file) {\r\n        if (!file.serverId || this.uploader.helper.searchUploadedFile(file.serverId) !== -1) {\r\n            return;\r\n        }\r\n\r\n        this.uploadedFiles.push(file)\r\n    }\r\n}\r\n","\r\nimport Helper from './Upload/Helper'\r\nimport Request from './Upload/Request'\r\nimport Input from './Upload/Input'\r\nimport Status from './Upload/Status'\r\nimport AddFile from './Upload/AddFile'\r\nimport AddUploadedFile from './Upload/AddUploadedFile'\r\n\r\n/**\r\n * WebUploader 上传组件\r\n *\r\n * @see http://fex.baidu.com/webuploader/\r\n */\r\n(function (w, $) {\r\n    let Dcat = w.Dcat;\r\n\r\n    class Uploader {\r\n        constructor(options) {\r\n            this.options = options = $.extend({\r\n                wrapper: '.web-uploader', // 图片显示容器选择器\r\n                addFileButton: '.add-file-button', // 继续添加按钮选择器\r\n                inputSelector: '',\r\n                isImage: false,\r\n                preview: [], // 数据预览\r\n                server: '',\r\n                updateServer: '',\r\n                autoUpload: false,\r\n                sortable: false,\r\n                deleteUrl: '',\r\n                deleteData: {},\r\n                thumbHeight: 160,\r\n                elementName: '',\r\n                disabled: false, // 禁止任何上传编辑\r\n                autoUpdateColumn: false,\r\n                removable: false, // 是否允许直接删除服务器图片\r\n                downloadable: false, // 是否允许下载文件\r\n                dimensions: {\r\n                    // width: 100, // 图片宽限制\r\n                    // height: 100, // 图片高限制\r\n                    // min_width: 100, //\r\n                    // min_height: 100,\r\n                    // max_width: 100,\r\n                    // max_height: 100,\r\n                    // ratio: 3/2, // 宽高比\r\n                },\r\n                lang: {\r\n                    exceed_size: '文件大小超出',\r\n                    interrupt: '上传暂停',\r\n                    upload_failed: '上传失败，请重试',\r\n                    selected_files: '选中:num个文件，共:size。',\r\n                    selected_has_failed: '已成功上传:success个文件，:fail个文件上传失败，<a class=\"retry\"  href=\"javascript:\"\";\">重新上传</a>失败文件或<a class=\"ignore\" href=\"javascript:\"\";\">忽略</a>',\r\n                    selected_success: '共:num个(:size)，已上传:success个。',\r\n                    dot: '，',\r\n                    failed_num: '失败:fail个。',\r\n                    pause_upload: '暂停上传',\r\n                    go_on_upload: '继续上传',\r\n                    start_upload: '开始上传',\r\n                    upload_success_message: '已成功上传:success个文件',\r\n                    go_on_add: '继续添加',\r\n                    Q_TYPE_DENIED: '对不起，不允许上传此类型文件',\r\n                    Q_EXCEED_NUM_LIMIT: '对不起，已超出文件上传数量限制，最多只能上传:num个文件',\r\n                    F_EXCEED_SIZE: '对不起，当前选择的文件过大',\r\n                    Q_EXCEED_SIZE_LIMIT: '对不起，已超出文件大小限制',\r\n                    F_DUPLICATE: '文件重复',\r\n                    confirm_delete_file: '您确定要删除这个文件吗？',\r\n                },\r\n                upload: { // web-uploader配置\r\n                    formData: {\r\n                        _id: null, // 唯一id\r\n                    },\r\n                    thumb: {\r\n                        width: 160,\r\n                        height: 160,\r\n                        quality: 70,\r\n                        allowMagnify: true,\r\n                        crop: true,\r\n                        preserveHeaders: false,\r\n                        // 为空的话则保留原有图片格式。\r\n                        // 否则强制转换成指定的类型。\r\n                        // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\r\n                        // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\r\n                        type: 'image/jpeg'\r\n                    },\r\n                }\r\n            }, options);\r\n\r\n            let _this = this;\r\n\r\n            // WebUploader\r\n            // @see http://fex.baidu.com/webuploader/\r\n            _this.uploader = WebUploader.create(options.upload);\r\n\r\n            _this.$selector = $(options.selector);\r\n            _this.updateColumn = options.upload.formData.upload_column || ('webup' + Dcat.helpers.random());\r\n            _this.relation = options.upload.formData._relation; // 一对多关联关系名称\r\n\r\n            // 帮助函数\r\n            let helper = new Helper(this),\r\n                // 请求处理\r\n                request = new Request(this),\r\n                // 状态管理\r\n                status = new Status(this),\r\n                // 添加文件\r\n                addFile = new AddFile(this),\r\n                // 添加已上传文件\r\n                addUploadedFile = new AddUploadedFile(this),\r\n                // 表单\r\n                input = new Input(this);\r\n\r\n            _this.helper = helper;\r\n            _this.request = request;\r\n            _this.status = status;\r\n            _this.addFile = addFile;\r\n            _this.addUploadedFile = addUploadedFile;\r\n            _this.input = input;\r\n\r\n            // 翻译\r\n            _this.lang = Dcat.Translator(options.lang);\r\n\r\n            // 所有文件的进度信息，key为file id\r\n            _this.percentages = {};\r\n            // 临时存储上传失败的文件，key为file id\r\n            _this.faildFiles = {};\r\n            // 临时存储添加到form表单的文件\r\n            _this.formFiles = {};\r\n            // 添加的文件数量\r\n            _this.fileCount = 0;\r\n            // 添加的文件总大小\r\n            _this.fileSize = 0;\r\n\r\n            if (typeof options.upload.formData._id === \"undefined\" || ! options.upload.formData._id) {\r\n                options.upload.formData._id = _this.updateColumn + Dcat.helpers.random();\r\n            }\r\n        }\r\n\r\n        // 初始化\r\n        build() {\r\n            let _this = this,\r\n                uploader = _this.uploader,\r\n                options = _this.options,\r\n                $wrap = _this.$selector.find(options.wrapper),\r\n                // 图片容器\r\n                $queue = $('<ul class=\"filelist\"></ul>').appendTo($wrap.find('.queueList')),\r\n                // 状态栏，包括进度和控制按钮\r\n                $statusBar = $wrap.find('.statusBar'),\r\n                // 文件总体选择信息。\r\n                $info = $statusBar.find('.info'),\r\n                // 上传按钮\r\n                $upload = $wrap.find('.upload-btn'),\r\n                // 没选择文件之前的内容。\r\n                $placeholder = $wrap.find('.placeholder'),\r\n                $progress = $statusBar.find('.upload-progress').hide();\r\n\r\n            // jq选择器\r\n            _this.$wrapper = $wrap;\r\n            _this.$files = $queue;\r\n            _this.$statusBar = $statusBar;\r\n            _this.$uploadButton = $upload;\r\n            _this.$placeholder = $placeholder;\r\n            _this.$progress = $progress;\r\n            _this.$infoBox = $info;\r\n\r\n            if (options.upload.fileNumLimit > 1 && ! options.disabled) {\r\n                // 添加“添加文件”的按钮，\r\n                uploader.addButton({\r\n                    id: options.addFileButton,\r\n                    label: '<i class=\"feather icon-folder\"></i> &nbsp;' + _this.lang.trans('go_on_add')\r\n                });\r\n            }\r\n\r\n            // 拖拽时不接受 js, txt 文件。\r\n            _this.uploader.on('dndAccept', function (items) {\r\n                var denied = false,\r\n                    len = items.length,\r\n                    i = 0,\r\n                    // 修改js类型\r\n                    unAllowed = 'text/plain;application/javascript ';\r\n\r\n                for (; i < len; i++) {\r\n                    // 如果在列表里面\r\n                    if (~unAllowed.indexOf(items[i].type)) {\r\n                        denied = true;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                return !denied;\r\n            });\r\n\r\n            // 进度条更新\r\n            uploader.onUploadProgress = function (file, percentage) {\r\n                _this.percentages[file.id][1] = percentage;\r\n                _this.status.updateProgress();\r\n            };\r\n\r\n            // uploader.onBeforeFileQueued = function (file) {};\r\n\r\n            // 添加文件\r\n            uploader.onFileQueued = function (file) {\r\n                _this.fileCount++;\r\n                _this.fileSize += file.size;\r\n\r\n                if (_this.fileCount === 1) {\r\n                    // 隐藏 placeholder\r\n                    $placeholder.addClass('element-invisible');\r\n                    $statusBar.show();\r\n                }\r\n\r\n                // 添加文件\r\n                _this.addFile.render(file);\r\n                _this.status.switch('ready');\r\n\r\n                // 更新进度条\r\n                _this.status.updateProgress();\r\n\r\n                if (!options.disabled && options.autoUpload) {\r\n                    // 自动上传\r\n                    uploader.upload()\r\n                }\r\n            };\r\n\r\n            // 删除文件事件监听\r\n            uploader.onFileDequeued = function (file) {\r\n                _this.fileCount--;\r\n                _this.fileSize -= file.size;\r\n\r\n                if (! _this.fileCount && !Dcat.helpers.len(_this.formFiles)) {\r\n                    _this.status.switch('pending');\r\n                }\r\n\r\n                _this.removeUploadFile(file);\r\n            };\r\n\r\n            uploader.on('all', function (type, obj, reason) {\r\n                switch (type) {\r\n                    case 'uploadFinished':\r\n                        _this.status.switch('confirm');\r\n                        // 保存已上传的文件名到服务器\r\n                        _this.request.update();\r\n                        break;\r\n\r\n                    case 'startUpload':\r\n                        _this.status.switch('uploading');\r\n                        break;\r\n\r\n                    case 'stopUpload':\r\n                        _this.status.switch('paused');\r\n                        break;\r\n                    case  'uploadAccept':\r\n                        if (_this._uploadAccept(obj, reason) === false) {\r\n                            return false;\r\n                        }\r\n\r\n                        break;\r\n                }\r\n            });\r\n\r\n            uploader.onError = function (code) {\r\n                switch (code) {\r\n                    case 'Q_TYPE_DENIED':\r\n                        Dcat.error(_this.lang.trans('Q_TYPE_DENIED'));\r\n                        break;\r\n                    case 'Q_EXCEED_NUM_LIMIT':\r\n                        Dcat.error(_this.lang.trans('Q_EXCEED_NUM_LIMIT', {num: options.upload.fileNumLimit}));\r\n                        break;\r\n                    case 'F_EXCEED_SIZE':\r\n                        Dcat.error(_this.lang.trans('F_EXCEED_SIZE'));\r\n                        break;\r\n                    case 'Q_EXCEED_SIZE_LIMIT':\r\n                        Dcat.error(_this.lang.trans('Q_EXCEED_SIZE_LIMIT'));\r\n                        break;\r\n                    case 'F_DUPLICATE':\r\n                        Dcat.warning(_this.lang.trans('F_DUPLICATE'));\r\n                        break;\r\n                    default:\r\n                        Dcat.error('Error: ' + code);\r\n                }\r\n\r\n            };\r\n\r\n            // 上传按钮点击\r\n            $upload.on('click', function () {\r\n                let state = _this.status.state;\r\n\r\n                if ($(this).hasClass('disabled')) {\r\n                    return false;\r\n                }\r\n\r\n                if (state === 'ready') {\r\n                    uploader.upload();\r\n                } else if (state === 'paused') {\r\n                    uploader.upload();\r\n                } else if (state === 'uploading') {\r\n                    uploader.stop();\r\n                }\r\n            });\r\n\r\n            // 重试按钮\r\n            $info.on('click', '.retry', function () {\r\n                uploader.retry();\r\n            });\r\n\r\n            // 忽略按钮\r\n            $info.on('click', '.ignore', function () {\r\n                for (let i in _this.faildFiles) {\r\n                    uploader.removeFile(i, true);\r\n\r\n                    delete _this.faildFiles[i];\r\n                }\r\n\r\n            });\r\n\r\n            // 初始化\r\n            _this.status.switch('init');\r\n        }\r\n\r\n        _uploadAccept(obj, reason) {\r\n            let _this = this,\r\n                options = _this.options;\r\n\r\n            // 上传失败，返回false\r\n            if (! reason || ! reason.status) {\r\n                _this.helper.showError(reason);\r\n\r\n                _this.faildFiles[obj.file.id] = obj.file;\r\n\r\n                return false;\r\n            }\r\n\r\n            if (reason.data && reason.data.merge) {\r\n                // 分片上传\r\n                return;\r\n            }\r\n\r\n            // 上传成功，保存新文件名和路径到file对象\r\n            obj.file.serverId = reason.data.id;\r\n            obj.file.serverName = reason.data.name;\r\n            obj.file.serverPath = reason.data.path;\r\n            obj.file.serverUrl = reason.data.url || null;\r\n\r\n            _this.addUploadedFile.add(obj.file);\r\n\r\n            _this.input.add(reason.data.id);\r\n\r\n            let $li = _this.getFileView(obj.file.id);\r\n\r\n            if (! _this.isImage()) {\r\n                $li.find('.file-action').hide();\r\n                $li.find('[data-file-act=\"delete\"]').show();\r\n            }\r\n\r\n            if (options.sortable) {\r\n                $li.find('[data-file-act=\"order\"]').removeClass('d-none').show();\r\n            }\r\n            if (options.downloadable) {\r\n                let $download = $li.find('[data-file-act=\"download\"]');\r\n                $download.removeClass('d-none').show();\r\n                $download.attr('data-id', obj.file.serverUrl);\r\n            }\r\n        }\r\n\r\n        // 预览\r\n        preview() {\r\n            let _this = this,\r\n                options = _this.options,\r\n                i;\r\n\r\n            for (i in options.preview) {\r\n                let path = options.preview[i].path, ext;\r\n\r\n                if (path.indexOf('.')) {\r\n                    ext = path.split('.').pop();\r\n                }\r\n\r\n                let file = {\r\n                    serverId: options.preview[i].id,\r\n                    serverUrl: options.preview[i].url,\r\n                    serverPath: path,\r\n                    ext: ext,\r\n                    fake: 1,\r\n                };\r\n\r\n                _this.status.switch('incrOriginalFileNum');\r\n                _this.status.switch('decrFileNumLimit');\r\n\r\n                // 添加文件到预览区域\r\n                _this.addUploadedFile.render(file);\r\n                _this.addUploadedFile.add(file);\r\n            }\r\n        }\r\n\r\n        // 重新渲染已上传文件\r\n        reRenderUploadedFiles() {\r\n            let _this = this;\r\n\r\n            _this.$files.html('');\r\n\r\n            _this.addUploadedFile.reRender();\r\n        }\r\n\r\n        // 重置按钮位置\r\n        refreshButton() {\r\n            this.uploader.refresh();\r\n        }\r\n\r\n        // 获取文件视图选择器\r\n        getFileViewSelector(fileId) {\r\n            return this.options.elementName.replace(/[\\[\\]]*/g, '_') + '-' + fileId;\r\n        }\r\n\r\n        getFileView(fileId) {\r\n            return $('#' + this.getFileViewSelector(fileId));\r\n        }\r\n\r\n        // 负责view的销毁\r\n        removeUploadFile(file) {\r\n            let _this = this,\r\n                $li = _this.getFileView(file.id);\r\n\r\n            delete _this.percentages[file.id];\r\n            _this.status.updateProgress();\r\n\r\n            $li.off().find('.file-panel').off().end().remove();\r\n        }\r\n\r\n        // 上传字段名称\r\n        getColumn() {\r\n            return this.updateColumn\r\n        }\r\n\r\n        // 判断是否是图片上传\r\n        isImage() {\r\n            return this.options.isImage\r\n        }\r\n    }\r\n\r\n    Dcat.Uploader = function (options) {\r\n        return new Uploader(options)\r\n    };\r\n\r\n})(window, jQuery);\r\n"],"sourceRoot":""}